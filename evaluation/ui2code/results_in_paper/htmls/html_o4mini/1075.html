<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>家庭愿望清单</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
  <style>
    body { font-family: 'Noto Sans SC', sans-serif; }
  </style>
</head>
<body class="bg-yellow-50">
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const priorityMap = { high: { label: '高', color: 'bg-red-200 text-red-800' },
                          med:  { label: '中', color: 'bg-yellow-200 text-yellow-800' },
                          low:  { label: '低', color: 'bg-gray-200 text-gray-800' } };
    function formatDate(dateStr){
      const d = new Date(dateStr);
      const y = d.getFullYear();
      const m = ('' + (d.getMonth()+1)).padStart(2,'0');
      const dd = ('' + d.getDate()).padStart(2,'0');
      return `${y}年${m}月${dd}日`;
    }
    function App(){
      const today = new Date().toISOString().slice(0,10);
      const [wishes, setWishes] = useState([
        { id:1, title:'家庭电影之夜', date:'2023-09-21', priority:'low', note:'每人选一部最爱的电影，准备爆米花和软饮料，享受家庭电影时光', completed:true },
        { id:2, title:'家庭周末野餐', date:'2023-09-29', priority:'high', note:'带上野餐篮和最爱美食，去城市公园野餐', completed:false },
        { id:3, title:'孩子生日派对', date:'2023-10-14', priority:'med', note:'为孩子准备一个主题派对，邀请他的好朋友们参加', completed:false },
      ]);
      const [showAdd, setShowAdd] = useState(false);
      const [showEdit, setShowEdit] = useState(false);
      const [editWish, setEditWish] = useState(null);
      const [searchText, setSearchText] = useState('');
      const [filterStatus, setFilterStatus] = useState('all'); // all, completed, incomplete
      const [sortBy, setSortBy] = useState('time'); // time or priority

      function handleAdd(){
        setShowAdd(true);
      }
      function handleEdit(w){
        setEditWish(w);
        setShowEdit(true);
      }
      function handleDelete(id){
        if(window.confirm('确认删除此愿望？')){
          setWishes(ws => ws.filter(w=>w.id!==id));
        }
      }
      function toggleComplete(id){
        setWishes(ws=>ws.map(w=>w.id===id?{...w,completed:!w.completed}:w));
      }
      function addSubmit(e){
        e.preventDefault();
        const f = e.target;
        const newWish = {
          id: Date.now(),
          title: f.title.value,
          date: f.date.value,
          priority: f.priority.value,
          note: f.note.value,
          completed: false
        };
        setWishes(ws=>[...ws,newWish]);
        setShowAdd(false);
        f.reset();
      }
      function editSubmit(e){
        e.preventDefault();
        const f = e.target;
        setWishes(ws=>ws.map(w=>w.id===editWish.id?{
          ...w,
          title:f.title.value,
          date:f.date.value,
          priority:f.priority.value,
          note:f.note.value
        }:w));
        setShowEdit(false);
      }
      function cancelModal(){
        setShowAdd(false);
        setShowEdit(false);
      }
      // filtering and sorting
      let display = wishes.filter(w=>{
        const m = w.title.includes(searchText);
        if(!m) return false;
        if(filterStatus==='completed') return w.completed;
        if(filterStatus==='incomplete') return !w.completed;
        return true;
      });
      if(sortBy==='time'){
        display.sort((a,b)=>new Date(a.date)-new Date(b.date));
      } else {
        const val = p=>p==='high'?3:p==='med'?2:1;
        display.sort((a,b)=>val(b.priority)-val(a.priority));
      }
      const total = wishes.length;
      const completedCount = wishes.filter(w=>w.completed).length;
      const dueToday = wishes.filter(w=>w.date===today).length;
      const rate = total?Math.round(completedCount/total*100):0;
      const circumference = 2*Math.PI*45;
      const completedLen = circumference * (completedCount/ (total||1));
      return (
        <div>
          {/* Header */}
          <header className="bg-yellow-400 text-white px-6 py-4 flex justify-between items-center shadow">
            <div className="flex items-center text-lg font-semibold"><i className="fas fa-home mr-2"></i>家庭愿望清单</div>
            <button onClick={handleAdd} className="bg-yellow-500 hover:bg-yellow-600 px-4 py-2 rounded text-white flex items-center">
              <i className="fas fa-plus mr-2"></i>添加愿望
            </button>
          </header>
          <div className="flex px-6 py-6 space-x-6">
            {/* Left menu */}
            <nav className="w-56 bg-white rounded shadow p-4 space-y-4">
              <div className="text-lg font-medium mb-2">菜单</div>
              <ul className="space-y-2">
                <li className="flex items-center"><i className="fas fa-star mr-2 text-yellow-500"></i>所有愿望</li>
                <li className="flex items-center"><i className="fas fa-calendar-day mr-2 text-blue-500"></i>今日到期</li>
                <li className="flex items-center"><i className="fas fa-check-circle mr-2 text-green-500"></i>已完成愿望</li>
                <li className="flex items-center"><i className="fas fa-exclamation-circle mr-2 text-red-500"></i>紧急愿望</li>
              </ul>
              <div className="mt-6 p-3 bg-yellow-100 rounded text-sm">
                <i className="fas fa-lightbulb text-yellow-600 mr-2"></i>定期更新你的愿望清单，让家庭生活充满期待与惊喜！
              </div>
            </nav>
            {/* Main content */}
            <main className="flex-1 space-y-6">
              {/* Filters */}
              <div className="bg-white p-4 rounded shadow flex items-center justify-between">
                <div className="flex items-center space-x-4">
                  <div className="flex items-center bg-gray-100 rounded px-3 py-2">
                    <i className="fas fa-search text-gray-500 mr-2"></i>
                    <input
                      type="text"
                      placeholder="搜索愿望..."
                      className="bg-transparent focus:outline-none text-gray-700"
                      value={searchText}
                      onChange={e=>setSearchText(e.target.value)}
                    />
                  </div>
                  <select
                    value={filterStatus}
                    onChange={e=>setFilterStatus(e.target.value)}
                    className="px-3 py-2 bg-gray-100 rounded focus:outline-none"
                  >
                    <option value="all">全部显示</option>
                    <option value="completed">已完成</option>
                    <option value="incomplete">未完成</option>
                  </select>
                </div>
                <div className="space-x-2">
                  <button
                    className={"px-4 py-2 rounded "+(sortBy==='time'?'bg-blue-200 text-blue-800':'bg-gray-100 text-gray-600')}
                    onClick={()=>setSortBy('time')}
                  >时间</button>
                  <button
                    className={"px-4 py-2 rounded "+(sortBy==='priority'?'bg-yellow-200 text-yellow-800':'bg-gray-100 text-gray-600')}
                    onClick={()=>setSortBy('priority')}
                  >优先级</button>
                </div>
              </div>
              {/* Wish list */}
              <div className="space-y-4">
                {display.map(w=>(
                  <div key={w.id} className="bg-white p-4 rounded shadow flex justify-between">
                    <div className="space-y-2">
                      <div className="text-lg font-medium">{w.title}</div>
                      <div className="text-sm text-gray-500 flex items-center">
                        <i className="fas fa-calendar-alt mr-1"></i>截止日期:{formatDate(w.date)}
                      </div>
                      <div className="text-sm text-gray-700">{w.note}</div>
                      <div className="flex items-center space-x-4 mt-2">
                        <span className={"px-2 py-1 text-sm rounded "+priorityMap[w.priority].color}>{priorityMap[w.priority].label}</span>
                        <label className="flex items-center space-x-2 text-sm">
                          <span>状态：</span>
                          <div onClick={()=>toggleComplete(w.id)} className={"w-10 h-5 flex items-center bg-gray-300 rounded-full p-1 cursor-pointer "+(w.completed?'bg-green-400':'')}>
                            <div className={"bg-white w-4 h-4 rounded-full shadow transform "+(w.completed?'translate-x-5':'')}></div>
                          </div>
                          <span>{w.completed?'已完成':'未完成'}</span>
                        </label>
                      </div>
                    </div>
                    <div className="flex flex-col items-end space-y-2">
                      <button onClick={()=>handleEdit(w)} className="text-blue-500 hover:text-blue-700"><i className="fas fa-edit"></i> 编辑</button>
                      <button onClick={()=>handleDelete(w.id)} className="text-red-500 hover:text-red-700"><i className="fas fa-trash"></i> 删除</button>
                    </div>
                  </div>
                ))}
                {display.length===0 && <div className="text-center text-gray-500 py-6">暂无愿望</div>}
              </div>
              {/* Footer info */}
              <div className="grid grid-cols-2 gap-4">
                <div className="bg-white p-4 rounded shadow text-sm">
                  <div className="flex items-center mb-2"><i className="fas fa-info-circle text-blue-500 mr-2"></i><span className="font-medium">如何使用家庭愿望清单</span></div>
                  <ol className="list-decimal list-inside space-y-1">
                    <li>点击“添加愿望”按钮，填写愿望标题、截止日期和其他信息</li>
                    <li>点击卡片右上角的“编辑”按钮修改愿望详情</li>
                    <li>点击“删除”按钮可以移除不需要的愿望</li>
                    <li>通过筛选和排序功能快速查找特定愿望</li>
                    <li>使用开关切换愿望的完成状态</li>
                  </ol>
                </div>
                <div className="bg-white p-4 rounded shadow text-sm">
                  <div className="flex items-center mb-2"><i className="fas fa-exclamation-circle text-yellow-500 mr-2"></i><span className="font-medium">温馨提示</span></div>
                  <p>和家人一起制定愿望清单，让每一个家庭时刻充满期待与仪式感！记录下你们要一起完成的事情，创造美好回忆。</p>
                  <div className="mt-4 text-xs text-gray-500">
                    家庭愿望清单 v1.0<br/>
                    联系我们: family@wishlist.example.com
                  </div>
                </div>
              </div>
            </main>
            {/* Right panel */}
            <aside className="w-64 space-y-6">
              <div className="bg-white p-4 rounded shadow">
                <div className="text-lg font-medium mb-2 flex items-center"><i className="fas fa-chart-pie text-blue-500 mr-2"></i>愿望统计</div>
                <div className="flex justify-center mb-2">
                  <svg width="100" height="100">
                    <circle cx="50" cy="50" r="45" stroke="#FFD580" strokeWidth="10" fill="none" transform="rotate(-90 50 50)"/>
                    <circle cx="50" cy="50" r="45" stroke="#34D399" strokeWidth="10" fill="none" transform="rotate(-90 50 50)"
                      strokeDasharray={\`\${completedLen.toFixed(2)} \${circumference.toFixed(2)}\`} />
                  </svg>
                </div>
                <div className="flex justify-center space-x-4 text-sm mb-4">
                  <div className="flex items-center"><span className="inline-block w-3 h-3 bg-green-500 rounded-full mr-1"></span>已完成</div>
                  <div className="flex items-center"><span className="inline-block w-3 h-3 bg-yellow-500 rounded-full mr-1"></span>未完成</div>
                </div>
                <div className="space-y-2 text-sm">
                  <div className="flex justify-between"><span>愿望总数</span><span>{total}</span></div>
                  <div className="flex justify-between"><span>今日到期</span><span>{dueToday}</span></div>
                  <div className="flex justify-between"><span>完成率</span><span>{rate}%</span></div>
                </div>
              </div>
              <div className="bg-white p-4 rounded shadow">
                <div className="text-lg font-medium mb-2 flex items-center"><i className="fas fa-bolt text-purple-500 mr-2"></i>快捷操作</div>
                <div className="space-y-2">
                  <button onClick={handleAdd} className="w-full bg-green-400 hover:bg-green-500 text-white py-2 rounded flex items-center justify-center"><i className="fas fa-plus mr-2"></i>添加新愿望</button>
                  <button onClick={()=>window.print()} className="w-full bg-blue-400 hover:bg-blue-500 text-white py-2 rounded flex items-center justify-center"><i className="fas fa-print mr-2"></i>打印清单</button>
                  <button onClick={()=>alert('分享功能稍后上线')} className="w-full bg-yellow-400 hover:bg-yellow-500 text-white py-2 rounded flex items-center justify-center"><i className="fas fa-share-alt mr-2"></i>分享清单</button>
                </div>
              </div>
            </aside>
          </div>
          {/* Add Modal */}
          {showAdd && (
            <div className="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center">
              <div className="bg-white w-96 p-6 rounded shadow relative">
                <button onClick={cancelModal} className="absolute top-3 right-3 text-gray-500 hover:text-gray-700"><i className="fas fa-times"></i></button>
                <div className="text-lg font-medium mb-4 flex items-center"><i className="fas fa-plus-circle mr-2 text-yellow-500"></i>添加愿望</div>
                <form onSubmit={addSubmit} className="space-y-4">
                  <div>
                    <label className="block text-sm mb-1">愿望标题</label>
                    <input name="title" required className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none"/>
                  </div>
                  <div>
                    <label className="block text-sm mb-1">截止日期 <span className="text-red-500">*</span></label>
                    <input name="date" type="date" defaultValue={today} required className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none"/>
                  </div>
                  <div>
                    <label className="block text-sm mb-1">优先级</label>
                    <div className="space-x-4">
                      <label><input type="radio" name="priority" value="high" className="mr-1"/>高</label>
                      <label><input type="radio" name="priority" value="med" defaultChecked className="mr-1"/>中</label>
                      <label><input type="radio" name="priority" value="low" className="mr-1"/>低</label>
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm mb-1">备注</label>
                    <textarea name="note" rows="3" placeholder="添加备注信息..." className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none"></textarea>
                  </div>
                  <div className="flex justify-end space-x-2">
                    <button type="button" onClick={cancelModal} className="px-4 py-2 border border-gray-300 rounded text-gray-600">取消添加</button>
                    <button type="submit" className="px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-white rounded">添加愿望</button>
                  </div>
                </form>
              </div>
            </div>
          )}
          {/* Edit Modal */}
          {showEdit && editWish && (
            <div className="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center">
              <div className="bg-white w-96 p-6 rounded shadow relative">
                <button onClick={cancelModal} className="absolute top-3 right-3 text-gray-500 hover:text-gray-700"><i className="fas fa-times"></i></button>
                <div className="text-lg font-medium mb-4 flex items-center"><i className="fas fa-edit mr-2 text-blue-500"></i>编辑愿望</div>
                <form onSubmit={editSubmit} className="space-y-4">
                  <div>
                    <label className="block text-sm mb-1">愿望标题</label>
                    <input name="title" defaultValue={editWish.title} required className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none"/>
                  </div>
                  <div>
                    <label className="block text-sm mb-1">截止日期 <span className="text-red-500">*</span></label>
                    <input name="date" type="date" defaultValue={editWish.date} required className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none"/>
                  </div>
                  <div>
                    <label className="block text-sm mb-1">优先级</label>
                    <div className="space-x-4">
                      <label><input type="radio" name="priority" value="high" defaultChecked={editWish.priority==='high'} className="mr-1"/>高</label>
                      <label><input type="radio" name="priority" value="med" defaultChecked={editWish.priority==='med'} className="mr-1"/>中</label>
                      <label><input type="radio" name="priority" value="low" defaultChecked={editWish.priority==='low'} className="mr-1"/>低</label>
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm mb-1">备注</label>
                    <textarea name="note" rows="3" defaultValue={editWish.note} className="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none"></textarea>
                  </div>
                  <div className="flex justify-end space-x-2">
                    <button type="button" onClick={cancelModal} className="px-4 py-2 border border-gray-300 rounded text-gray-600">取消编辑</button>
                    <button type="submit" className="px-4 py-2 bg-blue-400 hover:bg-blue-500 text-white rounded">保存修改</button>
                  </div>
                </form>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<App/>, document.getElementById('root'));
  </script>
</body>
</html>
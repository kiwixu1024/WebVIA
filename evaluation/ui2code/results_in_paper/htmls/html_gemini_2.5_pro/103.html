<html>
<head>
    <meta charset="UTF-8" />
    <title>语音日记</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"></link>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        const INITIAL_DIARIES = [
          {
            id: 1,
            title: '小确幸录音',
            tag: '已听',
            date: '2024-06-20 22:15',
            metadata: '天气: 晴  时长: 02:35',
            imageUrl: 'https://picsum.photos/id/10/800/100',
            content: '今天下班路上看到彩虹，心情瞬间明媚...',
            emotion: '高兴'
          },
          {
            id: 2,
            title: '醒来感悟 ✨',
            tag: null,
            date: '2024-06-19 06:30',
            metadata: '平静  时长: 01:45',
            imageUrl: 'https://picsum.photos/id/20/800/100',
            content: '昨夜梦见故乡的老房子，心底涌上淡淡温暖...',
            emotion: '平静'
          },
          {
            id: 3,
            title: '工作压力',
            tag: '已听',
            date: '2024-06-18 19:45',
            metadata: '悲伤  时长: 23:12',
            imageUrl: 'https://picsum.photos/id/30/800/100',
            content: '今天项目截止日临近，感觉压力有点大，需要调整心态...',
            emotion: '悲伤'
          }
        ];

        const DiaryForm = ({ initialData, onClose }) => {
            const isEditing = !!initialData;
            const [title, setTitle] = useState(isEditing ? initialData.title : '');
            const [emotion, setEmotion] = useState(isEditing ? initialData.emotion : '平静');
            const [content, setContent] = useState(isEditing ? initialData.content : '');

            return (
                <div className="bg-white rounded-lg shadow-xl w-full max-w-lg p-6">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-xl font-semibold">{isEditing ? '编辑语音日记' : '新增语音日记'}</h2>
                        <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                            <i className="fas fa-times fa-lg"></i>
                        </button>
                    </div>
                    <form>
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-1">标题</label>
                            <input type="text" value={title} onChange={(e) => setTitle(e.target.value)} placeholder="请输入日记标题" className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500" />
                        </div>
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-1">情绪标签</label>
                            <select value={emotion} onChange={(e) => setEmotion(e.target.value)} className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 bg-white">
                                <option>平静</option>
                                <option>高兴</option>
                                <option>悲伤</option>
                                <option>激动</option>
                            </select>
                        </div>
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 mb-1">语音录制</label>
                            <div className="flex flex-col items-center justify-center h-24 border-2 border-dashed border-gray-300 rounded-md">
                                <div className="bg-orange-100 rounded-full h-12 w-12 flex items-center justify-center">
                                    <i className="fas fa-microphone text-orange-500 text-xl"></i>
                                </div>
                                <p className="text-sm text-gray-500 mt-2">点击开始录音</p>
                            </div>
                        </div>
                        <div className="mb-6">
                            <label className="block text-sm font-medium text-gray-700 mb-1">文字补充</label>
                            <textarea rows="3" value={content} onChange={(e) => setContent(e.target.value)} placeholder="添加文字记录，补充你的语音内容..." className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500"></textarea>
                        </div>
                        <div className="flex justify-end space-x-4">
                            <button type="button" onClick={onClose} className="px-6 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50">取消</button>
                            <button type="button" onClick={onClose} className="px-6 py-2 border border-transparent rounded-md text-white bg-orange-500 hover:bg-orange-600">保存</button>
                        </div>
                    </form>
                </div>
            );
        };
        
        const DiaryModal = ({ modalState, onClose }) => {
            if (!modalState.isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <DiaryForm initialData={modalState.data} onClose={onClose} />
                </div>
            );
        };

        const EmptyState = ({ onStart }) => {
            return (
                <div className="bg-white rounded-lg shadow-sm text-center py-20 px-6">
                    <div className="inline-block bg-gray-100 p-4 rounded-full">
                        <i className="fas fa-microphone-alt text-gray-400 text-4xl"></i>
                    </div>
                    <h3 className="mt-4 text-lg font-semibold text-gray-800">还没有语音日记</h3>
                    <p className="mt-1 text-sm text-gray-500">点击“新增语音日记”开始记录你的第一条语音</p>
                    <button onClick={onStart} className="mt-6 px-5 py-2.5 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500">
                        <i className="fas fa-plus mr-2"></i>立即开始记录
                    </button>
                </div>
            );
        }

        const DiaryItem = ({ entry, isSelected, onToggleSelect, onEdit }) => {
            return (
                <div className="bg-white rounded-lg shadow-sm p-5 border border-gray-200">
                    <div className="flex items-start space-x-4">
                        <input type="checkbox" checked={isSelected} onChange={() => onToggleSelect(entry.id)} className="mt-1 h-4 w-4 rounded border-gray-300 text-orange-500 focus:ring-orange-500" />
                        <div className="flex-1">
                            <div className="flex justify-between items-center mb-1">
                                <div className="flex items-center space-x-3">
                                    <h3 className="font-semibold text-base">{entry.title}</h3>
                                    {entry.tag && <span className="text-xs font-semibold bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full">{entry.tag}</span>}
                                </div>
                                <div className="text-sm text-blue-600">
                                    <button onClick={() => onEdit(entry)} className="hover:underline"><i className="fas fa-edit mr-1"></i>编辑</button>
                                    <button className="ml-4 hover:underline"><i className="fas fa-trash-alt mr-1"></i>删除</button>
                                </div>
                            </div>
                            <p className="text-xs text-gray-400 mb-3">{entry.date} &nbsp;&nbsp; {entry.metadata}</p>
                            <div className="mb-3">
                                <img src={entry.imageUrl} alt="waveform" className="w-full h-auto rounded" />
                            </div>
                            <p className="text-sm text-gray-600 mb-3">{entry.content}</p>
                            <div className="flex justify-between items-center">
                                <div className="flex items-center space-x-4 text-gray-400">
                                    <button><i className="far fa-heart"></i></button>
                                    <button><i className="far fa-comment"></i></button>
                                </div>
                                <button className="text-sm text-blue-600 hover:underline"><i className="fas fa-share-alt mr-2"></i>分享</button>
                            </div>
                        </div>
                    </div>
                </div>
            )
        };


        function App() {
            const [diaries, setDiaries] = useState(INITIAL_DIARIES);
            const [selectedIds, setSelectedIds] = useState(new Set());
            const [modalState, setModalState] = useState({ isOpen: false, type: null, data: null });

            const handleToggleSelect = (id) => {
                setSelectedIds(prev => {
                    const newSet = new Set(prev);
                    if (newSet.has(id)) {
                        newSet.delete(id);
                    } else {
                        newSet.add(id);
                    }
                    return newSet;
                });
            };
            
            // Interaction 1: After selecting one item, "批量删除" clears all items.
            const handleBulkDelete = () => {
                // As per instructions, this action clears all diaries to match screenshot 3 from screenshot 2.
                setDiaries([]);
                setSelectedIds(new Set());
            };

            // Interaction 2 & 4: Open new diary modal
            const handleOpenNewModal = () => {
                setModalState({ isOpen: true, type: 'new', data: null });
            };
            
            // Interaction 3: Open edit diary modal
            const handleOpenEditModal = (diary) => {
                setModalState({ isOpen: true, type: 'edit', data: diary });
            };

            const handleCloseModal = () => {
                setModalState({ isOpen: false, type: null, data: null });
            };

            const selectedCount = selectedIds.size;
            const areButtonsDisabled = selectedCount === 0;

            return (
                <div className="flex flex-col min-h-screen">
                    <header className="bg-white border-b border-gray-200">
                        <div className="max-w-screen-xl mx-auto px-8 flex justify-between items-center h-16">
                            <div className="flex items-center space-x-2">
                                <i className="fas fa-stream text-2xl text-orange-500"></i>
                                <span className="text-xl font-bold">日记总览</span>
                            </div>
                            <nav className="flex items-center space-x-8 text-gray-600">
                                <a href="#" className="hover:text-orange-500">录音编辑</a>
                                <a href="#" className="hover:text-orange-500">数据统计</a>
                                <a href="#" className="hover:text-orange-500">主题介绍</a>
                            </nav>
                        </div>
                    </header>

                    <div className="flex-1 max-w-screen-xl w-full mx-auto px-8 py-8">
                        <div className="grid grid-cols-12 gap-8">
                            
                            {/* Left Sidebar */}
                            <aside className="col-span-2">
                                <h2 className="text-xl font-bold flex items-center mb-6">
                                    <i className="fas fa-microphone-alt text-orange-500 mr-3"></i>
                                    语音日记
                                </h2>
                                <nav className="space-y-2">
                                    <a href="#" className="flex items-center px-4 py-2.5 text-gray-600 hover:bg-gray-100 rounded-lg">
                                        <i className="fas fa-home w-5 mr-3"></i>
                                        <span>首页</span>
                                    </a>
                                    <a href="#" className="flex items-center px-4 py-2.5 text-blue-600 bg-blue-50 rounded-lg border-l-4 border-blue-500 font-semibold">
                                        <i className="fas fa-file-alt w-5 mr-3"></i>
                                        <span>我的日记</span>
                                    </a>
                                    <a href="#" className="flex items-center px-4 py-2.5 text-gray-600 hover:bg-gray-100 rounded-lg">
                                        <i className="fas fa-bolt w-5 mr-3"></i>
                                        <span>快速录音</span>
                                    </a>
                                    <a href="#" className="flex items-center px-4 py-2.5 text-gray-600 hover:bg-gray-100 rounded-lg">
                                        <i className="fas fa-music w-5 mr-3"></i>
                                        <span>语音库</span>
                                    </a>
                                    <a href="#" className="flex items-center px-4 py-2.5 text-gray-600 hover:bg-gray-100 rounded-lg">
                                        <i className="fas fa-cog w-5 mr-3"></i>
                                        <span>设置</span>
                                    </a>
                                </nav>
                            </aside>

                            {/* Main Content */}
                            <main className="col-span-7">
                                <div className="flex justify-between items-center mb-5">
                                    <div className="flex items-center space-x-4">
                                        <h1 className="text-2xl font-bold">语音日记</h1>
                                        <div className="flex items-center space-x-2 text-sm text-gray-500">
                                            <input type="checkbox" className="h-4 w-4 rounded border-gray-300" disabled />
                                            <span>已选择 {selectedCount} 条</span>
                                        </div>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <button className={`px-4 py-2 rounded-lg text-sm font-semibold flex items-center space-x-2 ${areButtonsDisabled ? 'bg-green-100 text-green-300 cursor-not-allowed' : 'bg-green-100 text-green-600'}`} disabled={areButtonsDisabled}>
                                            <i className="fas fa-check"></i>
                                            <span>标记已听</span>
                                        </button>
                                        <button onClick={handleBulkDelete} className={`px-4 py-2 rounded-lg text-sm font-semibold flex items-center space-x-2 ${areButtonsDisabled ? 'bg-red-100 text-red-300 cursor-not-allowed' : 'bg-red-100 text-red-600'}`} disabled={areButtonsDisabled}>
                                            <i className="fas fa-trash"></i>
                                            <span>批量删除</span>
                                        </button>
                                    </div>
                                </div>
                                <div className="space-y-4">
                                    <button onClick={handleOpenNewModal} className="w-full text-left px-5 py-3 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600">
                                        + 新增语音日记
                                    </button>

                                    {diaries.length > 0 ? (
                                        <div className="space-y-4">
                                            {diaries.map(diary => (
                                                <DiaryItem 
                                                    key={diary.id}
                                                    entry={diary}
                                                    isSelected={selectedIds.has(diary.id)}
                                                    onToggleSelect={handleToggleSelect}
                                                    onEdit={handleOpenEditModal}
                                                />
                                            ))}
                                        </div>
                                    ) : (
                                        <EmptyState onStart={handleOpenNewModal} />
                                    )}
                                </div>
                            </main>

                            {/* Right Sidebar */}
                            <aside className="col-span-3 space-y-6">
                                <div className="bg-white rounded-lg shadow-sm p-5 border border-gray-200">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="font-semibold">录音统计</h3>
                                        <a href="#" className="text-sm text-blue-600 hover:underline">导出</a>
                                    </div>
                                    <div className="flex space-x-4 mb-4">
                                        <div>
                                            <p className="text-xs text-gray-500">本月录音</p>
                                            <p className="text-2xl font-bold">12<span className="text-sm font-normal text-gray-500 ml-1">次</span></p>
                                        </div>
                                        <div>
                                            <p className="text-xs text-gray-500">累计时长</p>
                                            <p className="text-2xl font-bold">03:45:20</p>
                                        </div>
                                    </div>
                                    <img src="https://picsum.photos/id/119/200/150" alt="vintage car" className="rounded-lg w-full"/>
                                </div>
                                <div className="bg-white rounded-lg shadow-sm p-5 border border-gray-200">
                                     <div className="flex justify-between items-center mb-4">
                                        <h3 className="font-semibold">情绪分布</h3>
                                        <a href="#" className="text-sm text-blue-600 hover:underline">导出</a>
                                    </div>
                                    <img src="https://picsum.photos/id/165/200/150" alt="sheep by the sea" className="rounded-lg w-full mb-4"/>
                                    <div className="grid grid-cols-2 gap-x-4 gap-y-2 text-xs">
                                        <div className="flex items-center"><span className="h-2 w-2 rounded-full bg-blue-300 mr-2"></span>平静 40%</div>
                                        <div className="flex items-center"><span className="h-2 w-2 rounded-full bg-yellow-300 mr-2"></span>高兴 30%</div>
                                        <div className="flex items-center"><span className="h-2 w-2 rounded-full bg-purple-300 mr-2"></span>悲伤 20%</div>
                                        <div className="flex items-center"><span className="h-2 w-2 rounded-full bg-red-300 mr-2"></span>激动 10%</div>
                                    </div>
                                </div>
                            </aside>
                        </div>
                    </div>

                    <footer className="bg-white border-t border-gray-200 mt-auto">
                       <div className="max-w-screen-xl mx-auto px-8 py-10">
                            <div className="grid grid-cols-12 gap-8 text-sm">
                                <div className="col-span-4">
                                    <h4 className="font-semibold mb-3">如何写好语音日记</h4>
                                    <ul className="space-y-2 text-gray-500">
                                        <li>1. 点击新增录制</li>
                                        <li>2. 语音自动转写</li>
                                        <li>3. 定期回顾导出</li>
                                        <li>4. 分享给好友</li>
                                    </ul>
                                </div>
                                <div className="col-span-4">
                                    <h4 className="font-semibold mb-3">帮助中心</h4>
                                    <ul className="space-y-2">
                                        <li><a href="#" className="text-blue-500 hover:underline">常见问题</a></li>
                                        <li><a href="#" className="text-blue-500 hover:underline">服务协议</a></li>
                                        <li><a href="#" className="text-blue-500 hover:underline">联系我们</a></li>
                                    </ul>
                                </div>
                                <div className="col-span-4">
                                    <h4 className="font-semibold mb-3">隐私保护</h4>
                                    <p className="text-gray-500">我们重视您的隐私安全，所有日记内容均经过加密存储，详情请参阅<a href="#" className="text-blue-500 hover:underline">隐私协议</a>。</p>
                                </div>
                            </div>
                            <div className="text-center text-xs text-gray-400 mt-10 pt-6 border-t border-gray-200">
                                © 2024 语音日记 All Rights Reserved
                            </div>
                       </div>
                    </footer>
                    
                    <div className="fixed bottom-8 right-8">
                        <button className="h-14 w-14 bg-orange-400 rounded-full text-white flex items-center justify-center shadow-lg hover:bg-orange-500">
                            <i className="fas fa-question text-2xl"></i>
                        </button>
                    </div>

                    <DiaryModal modalState={modalState} onClose={handleCloseModal} />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>
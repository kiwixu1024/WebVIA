<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家谱世系图谱</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [currentPage, setCurrentPage] = useState('home');
            const [isEditMode, setIsEditMode] = useState(false);
            const [isBranchEditing, setIsBranchEditing] = useState(false);
            const [branchName, setBranchName] = useState('');
            const [isDeletingBranch, setIsDeletingBranch] = useState(false);
            const [showAddMember, setShowAddMember] = useState(false);
            const [showConfirmDelete, setShowConfirmDelete] = useState(false);
            const [deletingBranch, setDeletingBranch] = useState('');
            
            // Form data
            const [formData, setFormData] = useState({
                name: '',
                gender: '男',
                familyBranch: '张氏支系',
                generation: '第 1 代',
                parent: '无父/母关联'
            });

            const [familyMembers] = useState({
                张氏支系: ['张大明', '张小红', '张明明'],
                李氏支系: [],
                王氏支系: []
            });

            const branchList = ['张氏支系', '李氏支系', '王氏支系'];

            const handleEditMode = () => {
                setIsEditMode(!isEditMode);
                if (!isEditMode) {
                    // Set to home page when switching to edit mode
                    setCurrentPage('home');
                    setIsBranchEditing(false);
                    setBranchName('');
                    setShowAddMember(false);
                    setShowConfirmDelete(false);
                }
            };

            const handleBranchClick = (branch = '') => {
                const branchNameList = branch.split('·');
                if (branchNameList.length > 1) {
                    setBranchName(branchNameList[0] + '·');
                    setIsBranchEditing(true);
                    setDeletingBranch('');
                    setShowAddMember(false);
                    setShowConfirmDelete(false);
                }
            };

            const handleEditBranchName = () => {
                setIsBranchEditing(true);
                setIsDeletingBranch('');
                setShowAddMember(false);
                setShowConfirmDelete(false);
            };

            const handleDeleteBranch = (branchName) => {
                setDeletingBranch(branchName);
                setIsDeletingBranch(branchName);
                setIsBranchEditing(false);
                setShowAddMember(false);
                setShowConfirmDelete(true);
            };

            const handleAddMember = () => {
                setShowAddMember(true);
                setIsBranchEditing(false);
                setShowConfirmDelete(false);
            };

            const handleFormSubmit = () => {
                // Handle form submission
            };

            const handleConfirmDelete = () => {
                // Confirmation logic here
                setShowConfirmDelete(false);
                setIsBranchEditing(false);
                setShowAddMember(false);
            };

            const handleCloseAddMember = () => {
                setShowAddMember(false);
                setIsBranchEditing(false);
                setShowConfirmDelete(false);
            };

            const handleExportPDF = () => {
                alert('PDF导出功能');
            };

            const handlePrint = () => {
                alert('打印功能');
            };

            const handleShare = () => {
                alert('分享链接功能');
            };

            // Modal content based on current state
            const getModalContent = () => {
                if (showAddMember) {
                    return (
                        <div className="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6">
                            <h3 className="text-center text-xl font-bold text-yellow-600 mb-4 inline-block">
                                加 {{isBranchEditing ? "测家族成员" : "添加家族成员"} }
                            </h3>
                            <div className="space-y-4">
                                {/* 姓名输入 */}
                                <div>
                                    <label className="block text-sm font-medium text-yellow-600 mb-1">
                                        姓名<span className="text-yellow-500"> *</span>
                                    </label>
                                    <input
                                        type="text"
                                        placeholder="请输入成员姓名"
                                        value={formData.name}
                                        onChange={(e) => setFormData({...formData, name: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    />
                                </div>

                                {/* 性别选择 */}
                                <div>
                                    <label className="block text-sm font-medium text-yellow-600 mb-1">性别</label>
                                    <select
                                        value={formData.gender}
                                        onChange={(e) => setFormData({...formData, gender: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value="男">男</option>
                                        <option value="女">女</option>
                                    </select>
                                </div>

                                {/* 所属家族分支 */}
                                <div>
                                    <label className="block text-sm font-medium text-yellow-600 mb-1">
                                        所属家族分支<span className="text-yellow-500"> *</span>
                                    </label>
                                    <select
                                        value={formData.familyBranch}
                                        onChange={(e) => setFormData({...formData, familyBranch: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        {branchList.map(branch => (
                                            <option key={branch} value={branch}>{branch}</option>
                                        ))}
                                    </select>
                                </div>

                                {/* 世代选择 */}
                                <div>
                                    <label className="block text-sm font-medium text-yellow-600 mb-1">世代</label>
                                    <select
                                        value={formData.generation}
                                        onChange={(e) => setFormData({...formData, generation: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value="第 1 代">第 1 代</option>
                                        <option value="第 2 代">第 2 代</option>
                                    </select>
                                </div>

                                {/* 父母选择 */}
                                <div>
                                    <label className="block text-sm font-medium text-yellow-600 mb-1">
                                        父/母<span className="text-yellow-500"> *</span>
                                    </label>
                                    <select
                                        value={formData.parent}
                                        onChange={(e) => setFormData({...formData, parent: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value="无父/母关联">无父/母关联</option>
                                        <option value="张大明">张大明</option>
                                        <option value="张小红">张小红</option>
                                        <option value="张明明">张明明</option>
                                    </select>
                                </div>

                                <div className="flex space-x-3 pt-4">
                                    <button
                                        onClick={handleCloseAddMember}
                                        className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"
                                    >
                                        取消
                                    </button>
                                    <button
                                        onClick={handleFormSubmit}
                                        className="flex-1 px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700"
                                    >
                                        保存
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }

                if (isBranchEditing) {
                    return (
                        <div className="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6">
                            <h3 className="text-center text-xl font-bold text-orange-600 mb-4 inline-block">
                                编辑家族分支
                            </h3>
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">
                                        分支名称<span className="text-orange-500"> *</span>
                                    </label>
                                    <input
                                        type="text"
                                        placeholder={formData.familyBranch}
                                        value={branchName}
                                        onChange={(e) => setBranchName(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    />
                                </div>

                                <div className="flex space-x-3 pt-4">
                                    <button
                                        onClick={() => setIsBranchEditing(false)}
                                        className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"
                                    >
                                        取消
                                    </button>
                                    <button
                                        onClick={() => setIsBranchEditing(false)}
                                        className="flex-1 px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700"
                                    >
                                        保存
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6">
                        <h3 className="text-center text-xl font-bold text-red-600 mb-4 inline-block">
                            确认删除分支
                        </h3>
                        <p className="text-center text-sm text-gray-600 mb-6">
                            确定要删除"{formData.familyBranch}"吗？此次操作将同时删除该分支下的所有成员数据，无法撤销。
                        </p>
                        <div className="flex space-x-3 pt-4">
                            <button
                                onClick={() => setShowConfirmDelete(false)}
                                className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"
                            >
                                取消
                            </button>
                            <button
                                onClick={handleConfirmDelete}
                                className="flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"
                            >
                                确认删除
                            </button>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-stone-100">
                    {/* Header */}
                    <div className="bg-amber-800 text-white p-4">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center">
                                <i className="fas fa-sitemap mr-2"></i>
                                <span className="text-xl font-bold">家谱世系图谱</span>
                            </div>
                            <div className="flex space-x-4">
                                <button
                                    onClick={handleEditMode}
                                    className="px-4 py-2 bg-amber-700 hover:bg-amber-600 rounded cursor-pointer"
                                >
                                    {isEditMode ? '首页总览' : '编辑模式'}
                                </button>
                                <button className="px-4 py-2 bg-amber-700 hover:bg-amber-600 rounded cursor-pointer">编辑模式</button>
                                <button className="px-4 py-2 bg-amber-700 hover:bg-amber-600 rounded cursor-pointer">统计分析</button>
                                <button className="px-4 py-2 bg-amber-700 hover:bg-amber-600 rounded cursor-pointer">帮助说明</button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto p-4">
                        <div className="flex space-x-6">
                            {/* Left Sidebar */}
                            <div className="w-80 bg-white rounded-lg shadow-lg p-4 h-fit">
                                <div className="flex items-center justify-between mb-4">
                                    <div className="flex items-center">
                                        <i className="fas fa-tree text-amber-600 mr-2"></i>
                                        <span className="font-bold text-lg">家族分支树</span>
                                    </div>
                                    <button className="bg-amber-600 text-white px-2 py-1 rounded text-xs">
                                        +
                                    </button>
                                </div>

                                <div className="space-y-3">
                                    {branchList.map(branch => (
                                        <div
                                            key={branch}
                                            className="flex items-center justify-between cursor-pointer"
                                            onClick={() => handleBranchClick(branch)}
                                        >
                                            <div className="flex items-center">
                                                <i className="fas fa-folder-industry text-amber-600 mr-2 text-sm"></i>
                                                <span className="text-gray-800">{branch}</span>
                                            </div>
                                            <div className="flex space-x-2">
                                                <button className="text-amber-600 hover:bg-amber-100 px-2 py-1 rounded text-xs">
                                                    <i className="fas fa-edit"></i>
                                                </button>
                                                <button className="text-amber-600 hover:bg-amber-100 px-2 py-1 rounded text-xs">
                                                    <i className="fas fa-eye"></i>
                                                </button>
                                                <button 
                                                    className="text-amber-600 hover:bg-amber-100 px-2 py-1 rounded text-xs"
                                                    onClick={() => handleDeleteBranch(branch)}
                                                >
                                                    <i className="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                <div className="mt-6 p-3 bg-yellow-100 rounded">
                                    <h4 className="font-medium text-amber-800 mb-2">家族谱系小贴士</h4>
                                    <p className="text-amber-700 text-sm">
                                        点击家族分支名称即可展开/收起该分支下的所有成员，使用右标志侧的编辑和删除按钮来管理残誉家族分支
                                    </p>
                                </div>
                            </div>

                            {/* Main Content */}
                            <div className="flex-1">
                                <div className="bg-white rounded-lg shadow-lg p-6">
                                    <div className="flex justify-between items-center mb-6">
                                        <h2 className="text-2xl font-bold text-amber-700">家谱子系图谱</h2>
                                        <button
                                            onClick={handleAddMember}
                                            className="bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700 flex items-center"
                                        >
                                            <i className="fas fa-user-plus mr-2"></i>
                                            添加成员 +
                                        </button>
                                    </div>

                                    <div className="border border-gray-200 rounded-lg p-6 mb-6">
                                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                            <div>
                                                <h3 className="text-lg font-bold text-gray-800 mb-4">张氏支系</h3>
                                                <div className="space-y-2">
                                                    <div className="flex justify-between items-center py-2">
                                                        <span className="font-medium">第 1 世代</span>
                                                        <button className="bg-amber-600 text-white px-3 py-1 rounded text-sm">
                                                            编辑
                                                        </button>
                                                    </div>
                                                    <div className="flex items-center space-x-2 mt-4">
                                                        <img src="https://picsum.photos/id/1027/100/100" alt="张大明" className="w-16 h-16 rounded-full object-cover" />
                                                        <div>
                                                            <div className="font-medium">张大明</div>
                                                            <div className="text-sm text-gray-600">男</div>
                                                        </div>
                                                    </div>
                                                    <div className="flex justify-between items-center py-2">
                                                        <span className="font-medium">第 2 世代</span>
                                                        <button className="bg-yellow-500 text-white px-3 py-1 rounded text-sm">
                                                            编辑
                                                        </button>
                                                    </div>
                                                    <div className="flex items-center space-x-2 mt-4">
                                                        <img src="https://picsum.photos/id/1015/100/100" alt="张小红" className="w-16 h-16 rounded-full object-cover" />
                                                        <div>
                                                            <div className="font-medium">张小红</div>
                                                            <div className="text-sm text-gray-600">女</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="lg:col-span-2 p-6 bg-amber-50 rounded-lg">
                                                <h3 className="text-lg font-bold text-amber-700 mb-4 text-center">张氏支系</h3>
                                                <div className="border-l-4 border-amber-200 pl-4">
                                                    <div className="text-sm text-gray-600 mb-2">第 1 世代</div>
                                                    <div className="flex justify-center space-x-8 py-6">
                                                        <div className="text-center">
                                                            <img src="https://picsum.photos/id/1027/150/150" alt="张大明" className="w-24 h-24 rounded-full object-cover mb-2 mx-auto" />
                                                            <div className="font-medium">张大明</div>
                                                            <div className="text-sm text-gray-600">男</div>
                                                        </div>
                                                        <div className="text-center">
                                                            <img src="https://picsum.photos/id/1084/150/150" alt="张小红" className="w-24 h-24 rounded-full object-cover mb-2 mx-auto" />
                                                            <div className="font-medium">张小红</div>
                                                            <div className="text-sm text-gray-600">女</div>
                                                        </div>
                                                    </div>
                                                    <div className="text-sm text-gray-600 mt-4 text-center">辈分: 张姓名</div>
                                                    <div className="text-sm text-gray-600 mt-2 text-center">出生年代: 1970年</div>
                                                </div>

                                                <div className="mt-6 border-l-4 border-amber-200 pl-4">
                                                    <div className="text-sm text-gray-600 mb-2">第 2 世代</div>
                                                    <div className="flex justify-center py-6">
                                                        <div className="text-center">
                                                            <img src="https://picsum.photos/id/1015/150/150" alt="张明明" className="w-24 h-24 rounded-full object-cover mb-2 mx-auto" />
                                                            <div className="font-medium">张明明</div>
                                                            <div className="text-sm text-gray-600">男</div>
                                                        </div>
                                                    </div>
                                                    <div className="text-sm text-gray-600 mt-4 text-center">辈分: 张姓名</div>
                                                    <div className="text-sm text-gray-600 mt-2 text-center">出生年代: 1995年</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="mt-6 bg-yellow-100 rounded-lg p-4">
                                            <div className="flex items-start">
                                                <i className="fas fa-info-circle text-yellow-600 mr-2 mt-0.5"></i>
                                                <div>
                                                    <h4 className="font-medium text-yellow-800 mb-1">小贴士：</h4>
                                                    <p className="text-yellow-700 text-sm leading-relaxed">
                                                        将鼠标悬停在成员头像上可显示编辑与删除按钮
                                                    </p>
                                                    <div className="mt-3">
                                                        <h4 className="font-medium text-yellow-800 mb-2">特色：</h4>
                                                        <p className="text-yellow-700 text-sm">
                                                            支持多代同堂展示，完整记录家族世系传承
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Right Sidebar */}
                            <div className="w-80 bg-white rounded-lg shadow-lg p-4 h-fit">
                                {/* Family Statistics */}
                                <div className="mb-6">
                                    <div className="flex items-center justify-between mb-4">
                                        <h3 className="font-bold text-orange-600">家族统计</h3>
                                        <button className="text-orange-600 hover:bg-orange-100 px-2 py-1 rounded text-sm">
                                            <i className="fas fa-sync-alt"></i>
                                        </button>
                                    </div>

                                    <div className="space-y-4">
                                        <div>
                                            <div className="text-sm text-gray-600 mb-1">
                                                <span className="text-orange-600">👤</span> 总成员数
                                            </div>
                                            <div className="text-2xl font-bold text-orange-600">{familyMembers['张氏支系'].length + familyMembers['李氏支系'].length + familyMembers['王氏支系'].length}</div>
                                            <div className="text-right">
                                                <i className="fas fa-users text-orange-500"></i>
                                            </div>
                                        </div>

                                        <div>
                                            <h4 className="font-medium text-gray-800 mb-2">性别比例</h4>
                                            <div className="w-full bg-gray-200 rounded-full h-6 mb-2">
                                                <div className="bg-blue-500 h-6 rounded-full" style={{width: '60%'}}></div>
                                            </div>
                                            <div className="flex justify-between text-sm">
                                                <div>
                                                    <div className="font-medium">男 <span className="text-blue-500">3</span></div>
                                                </div>
                                                <div>
                                                    <div className="font-medium">女 <span className="text-pink-500">2</span></div>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <h4 className="font-medium text-gray-800 mb-2">世代分布</h4>
                                            <div className="space-y-1 text-sm">
                                                <div className="flex justify-between">
                                                    <span>第 1 世代:</span>
                                                    <div className="flex-1 bg-gray-200 rounded-full h-3 mx-2">
                                                        <div className="bg-orange-500 h-3 rounded-full" style={{width: '100%'}}></div>
                                                    </div>
                                                    <span className="text-orange-600">3</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span>第 2 世代:</span>
                                                    <div className="flex-1 bg-gray-200 rounded-full h-3 mx-2">
                                                        <div className="bg-orange-500 h-3 rounded-full" style={{width: '100%'}}></div>
                                                    </div>
                                                    <span className="text-orange-600">2</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="bg-yellow-100 rounded-lg p-3 text-center">
                                            <div className="text-gray-800 font-medium">
                                                <i className="fas fa-info-circle mr-2"></i>
                                                数据说明：统计数据实时更新，反映当前录入的家族成员信息。
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Bottom Buttons */}
                        <div className="flex justify-between items-center mt-6">
                            <div className="flex space-x-3">
                                <button
                                    onClick={handleExportPDF}
                                    className="bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700 flex items-center"
                                >
                                    <i className="fas fa-file-pdf mr-2"></i>
                                    导出PDF
                                </button>
                                <button
                                    onClick={handlePrint}
                                    className="bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700 flex items-center"
                                >
                                    <i className="fas fa-print mr-2"></i>
                                    打印家谱
                                </button>
                                <button
                                    onClick={handleShare}
                                    className="bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700 flex items-center"
                                >
                                    <i className="fas fa-share-alt mr-2"></i>
                                    分享链接
                                </button>
                            </div>

                            <div className="text-sm text-gray-600 text-right">
                                <div className="text-xs">
                                    用户：家谱管理员 | 版本：1.0.3
                                </div>
                                <div className="text-xs text-center">© 2023 今家谱子系图谱 版权所有</div>
                            </div>
                        </div>
                    </div>

                    {/* Modal */}
                    {(showAddMember || showConfirmDelete || isBranchEditing) && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            {getModalContent()}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
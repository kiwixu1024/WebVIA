<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>交友社区</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .modal-bg { background: rgba(0,0,0,0.4); }
  </style>
</head>
<body class="bg-gray-100">
  <div id="root"></div>
  <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
  <script type="text/babel">
    const { useState } = React;

    function App() {
      const initialPost = {
        id: 1,
        author: 'Alice',
        avatar: 'https://picsum.photos/id/1005/40/40',
        datetime: '2023-11-12 14:30',
        title: '午后阳光漫步分享',
        content: '今天去了公园见到了可爱的松鼠，它们在树上跳来跳去，非常可爱！阳光透过树叶的缝隙洒在地上，形成了斑驳的光影，整个下午都沉浸在这美好的氛围中。',
        tags: ['日常','公园','小动物'],
        images: [
          'https://picsum.photos/id/1018/400/200',
          'https://picsum.photos/id/1015/400/200'
        ],
        visibility: 1 // 0:自己 1:好友可见 2:公开
      };

      const [post, setPost] = useState(initialPost);
      const [showPublish, setShowPublish] = useState(false);
      const [showTopic, setShowTopic] = useState(false);
      const [showAddFriend, setShowAddFriend] = useState(false);
      const [showEdit, setShowEdit] = useState(false);
      const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);

      // states for publish modal
      const defaultTags = ['旅行','美食','摄影','电影','音乐','宠物','运动','读书','游戏','生活'];
      const [pubTitle, setPubTitle] = useState('');
      const [pubContent, setPubContent] = useState('');
      const [pubTags, setPubTags] = useState([]);
      const [pubImages, setPubImages] = useState([]);
      const [pubVis, setPubVis] = useState(1);

      // states for add friend
      const [friendName, setFriendName] = useState('');
      const [friendIntro, setFriendIntro] = useState('');
      const [friendTags, setFriendTags] = useState([]);

      // states for edit modal
      const [editTitle, setEditTitle] = useState(post.title);
      const [editContent, setEditContent] = useState(post.content);
      const [editTags, setEditTags] = useState([...post.tags]);
      const [editImages, setEditImages] = useState([...post.images]);
      const [editVis, setEditVis] = useState(post.visibility);

      const toggleTag = (tag, list, setList) => {
        if (list.includes(tag)) {
          setList(list.filter(t => t !== tag));
        } else {
          setList([...list, tag]);
        }
      };

      const addPubImage = () => {
        if (pubImages.length < 4) {
          const next = `https://picsum.photos/id/${100 + pubImages.length}/400/200`;
          setPubImages([...pubImages, next]);
        }
      };
      const removePubImage = idx => {
        setPubImages(pubImages.filter((_, i) => i !== idx));
      };

      const addEditImage = () => {
        if (editImages.length < 4) {
          const next = `https://picsum.photos/id/${200 + editImages.length}/400/200`;
          setEditImages([...editImages, next]);
        }
      };
      const removeEditImage = idx => {
        setEditImages(editImages.filter((_, i) => i !== idx));
      };

      const handlePublish = () => {
        // for demo just close
        setShowPublish(false);
        setPubTitle(''); setPubContent(''); setPubTags([]); setPubImages([]); setPubVis(1);
      };
      const handleAddFriend = () => {
        setShowAddFriend(false);
        setFriendName(''); setFriendIntro(''); setFriendTags([]);
      };
      const handleSaveEdit = () => {
        setPost({
          ...post,
          title: editTitle,
          content: editContent,
          tags: [...editTags],
          images: [...editImages],
          visibility: editVis
        });
        setShowEdit(false);
      };
      const handleConfirmDelete = () => {
        setPost(null);
        setShowDeleteConfirm(false);
      };

      return (
        <div className="flex min-h-screen">
          {/* sidebar */}
          <aside className="w-64 bg-white p-6 flex flex-col justify-between">
            <div>
              <div className="flex items-center mb-8">
                <div className="w-10 h-10 flex items-center justify-center bg-orange-200 rounded-full text-orange-600 font-bold">F</div>
                <span className="ml-3 text-xl font-semibold text-orange-600">交友社区</span>
              </div>
              <nav className="space-y-4 text-gray-700">
                <div className="flex items-center space-x-2 cursor-pointer hover:text-orange-600"><i className="fas fa-user"></i><span>Profile</span></div>
                <div className="flex items-center space-x-2 cursor-pointer hover:text-orange-600"><i className="fas fa-envelope"></i><span>消息</span></div>
                <div className="flex items-center space-x-2 cursor-pointer hover:text-orange-600"><i className="fas fa-users"></i><span>好友广场</span></div>
                <div className="flex items-center space-x-2 cursor-pointer hover:text-orange-600"><i className="fas fa-calendar-alt"></i><span>活动中心</span></div>
                <div className="flex items-center space-x-2 cursor-pointer hover:text-orange-600"><i className="fas fa-cog"></i><span>设置</span></div>
              </nav>
            </div>
            <div className="bg-blue-100 p-3 text-blue-700 rounded text-sm">升级到 VIP 会员<br/>解锁更多交友功能！</div>
          </aside>
          {/* main */}
          <main className="flex-1 p-6">
            <header className="mb-6">
              <ul className="flex space-x-8 border-b">
                <li className="pb-2 border-b-2 border-orange-500 text-orange-600 font-medium">推荐</li>
                <li className="pb-2 text-gray-600 cursor-pointer">新朋友</li>
                <li className="pb-2 text-gray-600 cursor-pointer">热门话题</li>
                <li className="pb-2 text-gray-600 cursor-pointer">我的订阅</li>
              </ul>
            </header>
            {/* share bar */}
            <div className="flex items-center mb-6 space-x-4">
              <button onClick={()=>setShowPublish(true)} className="flex-1 h-10 bg-gradient-to-r from-orange-400 to-orange-200 text-white rounded-full px-4 font-medium"><i className="fas fa-pencil-alt mr-2"></i>发布动态</button>
              <button onClick={()=>setShowTopic(true)} className="flex-1 h-10 bg-gradient-to-r from-blue-300 to-blue-100 text-white rounded-full px-4 font-medium"><i className="fas fa-plus mr-2"></i>新增话题</button>
            </div>
            {/* post */}
            {post ? (
              <div className="bg-white rounded shadow p-6 relative">
                <div className="flex justify-between items-start">
                  <div className="flex items-center">
                    <img src={post.avatar} className="w-10 h-10 rounded-full mr-3"/>
                    <div>
                      <div className="font-semibold">{post.author}</div>
                      <div className="text-gray-500 text-sm">{post.datetime}</div>
                    </div>
                  </div>
                  <div className="space-x-2 text-gray-500">
                    <i onClick={()=>{ setEditTitle(post.title); setEditContent(post.content); setEditTags([...post.tags]); setEditImages([...post.images]); setEditVis(post.visibility); setShowEdit(true);} } className="fas fa-edit cursor-pointer hover:text-gray-700"></i>
                    <i onClick={()=>setShowDeleteConfirm(true)} className="fas fa-trash cursor-pointer hover:text-gray-700"></i>
                  </div>
                </div>
                <h3 className="mt-4 font-medium text-lg">{post.title}</h3>
                <p className="mt-2 text-gray-700">{post.content}</p>
                <div className="mt-4 grid grid-cols-2 gap-2">
                  {post.images.map((src, i)=>(
                    <img key={i} src={src} className="w-full h-40 object-cover rounded"/>
                  ))}
                </div>
                <div className="mt-4 flex flex-wrap space-x-2 text-sm">
                  {post.tags.map((t,i)=>(
                    <span key={i} className="bg-orange-100 text-orange-600 rounded px-2">{t}</span>
                  ))}
                </div>
                <div className="mt-4 flex items-center text-gray-500 space-x-4">
                  <div><i className="fas fa-heart"></i> 24</div>
                  <div><i className="fas fa-comment"></i> 5</div>
                  <div className="ml-auto cursor-pointer hover:text-gray-700"><i className="fas fa-share"></i></div>
                </div>
              </div>
            ) : (
              <div className="text-gray-500 text-center py-20">暂无动态</div>
            )}
          </main>
          {/* right panel */}
          <aside className="w-80 p-6 space-y-6">
            <div className="bg-white rounded shadow p-4">
              <h4 className="font-medium mb-2">社区数据</h4>
              <div className="flex justify-between text-gray-600"><span>在线人数</span><span className="text-orange-500">1287</span></div>
              <div className="flex justify-between text-gray-600 mt-1"><span>今日注册</span><span className="text-orange-500">456</span></div>
            </div>
            <div className="bg-white rounded shadow p-4">
              <h4 className="font-medium mb-2 flex justify-between">热门话题排行 <span className="text-sm text-orange-500 cursor-pointer">查看更多 &gt;</span></h4>
              <ol className="space-y-1 text-gray-700 text-sm">
                <li>1. 初秋旅行地点推荐 <span className="text-gray-400">2345人参与</span></li>
                <li>2. 周末约会好去处 <span className="text-gray-400">1892人参与</span></li>
                <li>3. 宠物友好咖啡厅 <span className="text-gray-400">1654人参与</span></li>
              </ol>
            </div>
            <div className="bg-white rounded shadow p-4">
              <h4 className="font-medium mb-2">推荐好友</h4>
              <div className="space-y-3">
                <div className="flex items-center"><img src="https://picsum.photos/id/1011/32/32" className="rounded-full mr-2"/><div><div>David</div><div className="text-gray-500 text-xs">摄影爱好者</div></div></div>
                <div className="flex items-center"><img src="https://picsum.photos/id/1012/32/32" className="rounded-full mr-2"/><div><div>Emma</div><div className="text-gray-500 text-xs">喜欢旅行和摄影</div></div></div>
              </div>
            </div>
            <div className="bg-white rounded shadow p-4 text-sm text-gray-700 relative">
              <div className="font-medium mb-1">小贴士 <i className="fas fa-times absolute top-3 right-3 cursor-pointer"></i></div>
              <p>在“热门话题”板块中点选可增强曝光率，更易吸引其他用户关注！</p>
              <p className="mt-2 flex items-center text-gray-500"><i className="fas fa-thumbs-up mr-2"></i>每天坚持互动可获得更多积分！</p>
            </div>
          </aside>

          {/* Publish Modal */}
          {showPublish && (
            <div className="fixed inset-0 flex items-center justify-center modal-bg z-50">
              <div className="bg-white rounded-lg w-2/5 p-6 relative">
                <h3 className="text-lg font-medium mb-4">发布新动态 <i onClick={()=>setShowPublish(false)} className="fas fa-times absolute top-4 right-4 cursor-pointer text-gray-500"></i></h3>
                <div className="space-y-4">
                  <div>
                    <label className="block mb-1 font-medium">标题</label>
                    <input type="text" maxLength="50" value={pubTitle} onChange={e=>setPubTitle(e.target.value)} placeholder="给你的动态起个标题" className="w-full border rounded p-2"/>
                    <div className="text-right text-gray-400 text-xs">{pubTitle.length}/50</div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">内容</label>
                    <textarea value={pubContent} onChange={e=>setPubContent(e.target.value)} maxLength="500" placeholder="分享你的精彩瞬间..." className="w-full border rounded p-2 h-24"></textarea>
                    <div className="text-right text-gray-400 text-xs">{pubContent.length}/500</div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">标签</label>
                    <div className="flex flex-wrap gap-2">
                      {defaultTags.map((t,i)=>(
                        <span key={i} onClick={()=>toggleTag(t,pubTags,setPubTags)} className={pubTags.includes(t)?'bg-blue-200 text-blue-600':'bg-gray-100 text-gray-600'} rounded-full px-3 py-1 text-sm cursor-pointer>{t}</span>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">图片</label>
                    <div className="flex flex-wrap gap-2">
                      {pubImages.map((src,i)=>(
                        <div key={i} className="relative">
                          <img src={src} className="w-24 h-16 object-cover rounded"/>
                          <i onClick={()=>removePubImage(i)} className="fas fa-times-circle absolute -top-2 -right-2 text-white bg-gray-600 rounded-full cursor-pointer"></i>
                        </div>
                      ))}
                      {pubImages.length < 4 && (
                        <div onClick={addPubImage} className="w-24 h-16 border-2 border-dashed border-gray-300 flex items-center justify-center rounded cursor-pointer text-gray-400 text-2xl">+</div>
                      )}
                    </div>
                    <div className="text-gray-400 text-xs mt-1">最多可添加4张图片</div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">可见度</label>
                    <input type="range" min="0" max="2" value={pubVis} onChange={e=>setPubVis(+e.target.value)} className="w-full"/>
                    <div className="flex justify-between text-gray-500 text-sm">
                      <span>仅自己</span><span>好友可见</span><span>公开</span>
                    </div>
                  </div>
                </div>
                <div className="mt-6 flex justify-end space-x-4">
                  <button onClick={()=>setShowPublish(false)} className="px-4 py-2 border rounded text-gray-600">取消</button>
                  <button onClick={handlePublish} className="px-4 py-2 bg-orange-500 text-white rounded">发布</button>
                </div>
              </div>
            </div>
          )}

          {/* Topic Modal (add friend) */}
          {showTopic && (
            <div className="fixed inset-0 flex items-center justify-center modal-bg z-50">
              <div className="bg-white rounded-lg w-2/5 p-6 relative">
                <h3 className="text-lg font-medium mb-4">添加新朋友 <i onClick={()=>setShowTopic(false)} className="fas fa-times absolute top-4 right-4 cursor-pointer text-gray-500"></i></h3>
                <div className="space-y-4">
                  <div>
                    <label className="block mb-1 font-medium">名称</label>
                    <input type="text" value={friendName} onChange={e=>setFriendName(e.target.value)} placeholder="输入好友名称" className="w-full border rounded p-2"/>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">简介</label>
                    <textarea value={friendIntro} onChange={e=>setFriendIntro(e.target.value)} placeholder="简单描述一下这位朋友" className="w-full border rounded p-2 h-20"></textarea>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">兴趣标签</label>
                    <div className="flex flex-wrap gap-2">
                      {defaultTags.map((t,i)=>(
                        <span key={i} onClick={()=>toggleTag(t,friendTags,setFriendTags)} className={friendTags.includes(t)?'bg-blue-200 text-blue-600':'bg-gray-100 text-gray-600'} rounded-full px-3 py-1 text-sm cursor-pointer>{t}</span>
                      ))}
                    </div>
                  </div>
                </div>
                <div className="mt-6 flex justify-end space-x-4">
                  <button onClick={()=>setShowTopic(false)} className="px-4 py-2 border rounded text-gray-600">取消</button>
                  <button onClick={handleAddFriend} className="px-4 py-2 bg-orange-500 text-white rounded">添加好友</button>
                </div>
              </div>
            </div>
          )}

          {/* Edit Modal */}
          {showEdit && (
            <div className="fixed inset-0 flex items-center justify-center modal-bg z-50">
              <div className="bg-white rounded-lg w-2/5 p-6 relative">
                <h3 className="text-lg font-medium mb-4">编辑动态 <i onClick={()=>setShowEdit(false)} className="fas fa-times absolute top-4 right-4 cursor-pointer text-gray-500"></i></h3>
                <div className="space-y-4">
                  <div>
                    <label className="block mb-1 font-medium">标题</label>
                    <input type="text" value={editTitle} onChange={e=>setEditTitle(e.target.value)} className="w-full border rounded p-2"/>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">内容</label>
                    <textarea value={editContent} onChange={e=>setEditContent(e.target.value)} className="w-full border rounded p-2 h-24"></textarea>
                    <div className="text-right text-gray-400 text-xs">{editContent.length}/500</div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">标签</label>
                    <div className="flex flex-wrap gap-2">
                      {defaultTags.map((t,i)=>(
                        <span key={i} onClick={()=>toggleTag(t,editTags,setEditTags)} className={editTags.includes(t)?'bg-blue-200 text-blue-600':'bg-gray-100 text-gray-600'} rounded-full px-3 py-1 text-sm cursor-pointer>{t}</span>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">图片</label>
                    <div className="flex flex-wrap gap-2">
                      {editImages.map((src,i)=>(
                        <div key={i} className="relative">
                          <img src={src} className="w-24 h-16 object-cover rounded"/>
                          <i onClick={()=>removeEditImage(i)} className="fas fa-times-circle absolute -top-2 -right-2 text-white bg-gray-600 rounded-full cursor-pointer"></i>
                        </div>
                      ))}
                      {editImages.length < 4 && (
                        <div onClick={addEditImage} className="w-24 h-16 border-2 border-dashed border-gray-300 flex items-center justify-center rounded cursor-pointer text-gray-400 text-2xl">+</div>
                      )}
                    </div>
                    <div className="text-gray-400 text-xs mt-1">最多可添加4张图片</div>
                  </div>
                  <div>
                    <label className="block mb-1 font-medium">可见度</label>
                    <input type="range" min="0" max="2" value={editVis} onChange={e=>setEditVis(+e.target.value)} className="w-full"/>
                    <div className="flex justify-between text-gray-500 text-sm">
                      <span>仅自己</span><span>好友可见</span><span>公开</span>
                    </div>
                  </div>
                </div>
                <div className="mt-6 flex justify-end space-x-4">
                  <button onClick={()=>setShowEdit(false)} className="px-4 py-2 border rounded text-gray-600">取消</button>
                  <button onClick={handleSaveEdit} className="px-4 py-2 bg-orange-500 text-white rounded">保存修改</button>
                </div>
              </div>
            </div>
          )}

          {/* Delete Confirm */}
          {showDeleteConfirm && (
            <div className="fixed inset-0 flex items-center justify-center modal-bg z-50">
              <div className="bg-white rounded-lg w-1/3 p-6 text-center">
                <h4 className="font-medium mb-4">确认删除</h4>
                <p className="text-gray-700 mb-6">确认要删除这条动态吗？删除后将无法恢复。</p>
                <div className="flex justify-center space-x-4">
                  <button onClick={()=>setShowDeleteConfirm(false)} className="px-4 py-2 border rounded text-gray-600">取消</button>
                  <button onClick={handleConfirmDelete} className="px-4 py-2 bg-red-500 text-white rounded">确认删除</button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>
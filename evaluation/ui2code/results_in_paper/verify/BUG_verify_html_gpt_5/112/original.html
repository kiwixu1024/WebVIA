<html>
<head>
  <meta charset="UTF-8" />
  <title>明信片分享</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
  <style>
    body { font-family: 'Roboto', sans-serif; }
    .modal-bg { background: rgba(0,0,0,0.5); }
  </style>
</head>
<body class="bg-yellow-50 min-h-screen flex flex-col">
  <div id="root" class="flex-grow"></div>
  <script type="text/babel">
    const { useState } = React;

    function App() {
      const initialCards = [
        { id:1, sender:'张小明', receiver:'李华', date:'2024-01-15', message:'新年快乐！希望你在新的一年里一切顺利，实现所有的愿望！', imgId:101 },
        { id:2, sender:'王芳', receiver:'赵敏', date:'2024-02-14', message:'情人节快乐！虽然相隔千里，但我的心意与你同在，期待下次见面！', imgId:102 },
        { id:3, sender:'陈晓', receiver:'刘强', date:'2024-03-08', message:'生日快乐！祝你新的一岁充满惊喜和幸福，愿所有美好如约而至。', imgId:103 },
        { id:4, sender:'林小雨', receiver:'张伟', date:'2024-04-01', message:'谢谢你的明信片！巴黎的景色真美，期待有一天我也能去那里旅行。', imgId:104 },
        { id:5, sender:'黄嘉嘉', receiver:'孙艺', date:'2024-04-15', message:'毕业快乐！四年时光匆匆，愿你前程似锦，未来可期。我们要一直保持联系哦！', imgId:105 },
        { id:6, sender:'周小一', receiver:'吴迪', date:'2024-05-01', message:'五一假期快乐！我已经到达海岛了，这里的海滩太美了，阳光明媚，海水蓝蓝，真想你也在这里。', imgId:106 }
      ];
      const imageOptions = [101,102,103,104,105];
      const [cards, setCards] = useState(initialCards);
      const [tab, setTab] = useState('展示区');
      const [showAdd, setShowAdd] = useState(false);
      const [showEdit, setShowEdit] = useState(false);
      const [editCard, setEditCard] = useState(null);
      const [showDelete, setShowDelete] = useState(false);
      const [delCard, setDelCard] = useState(null);
      const [stats, setStats] = useState({ share: initialCards.length, edit:0, del:0 });

      const openAdd = ()=>{ setShowAdd(true); setForm({ sender:'', receiver:'', date:new Date().toISOString().slice(0,10), message:'', imgId:imageOptions[0] }); }
      const [form, setForm] = useState({ sender:'', receiver:'', date:'', message:'', imgId:imageOptions[0] });

      const handleAddSave = ()=>{
        const newId = cards.length? Math.max(...cards.map(c=>c.id))+1 : 1;
        const newCard = { id:newId, sender:form.sender, receiver:form.receiver, date:form.date, message:form.message, imgId:form.imgId };
        setCards([...cards, newCard]);
        setStats({...stats, share: stats.share+1});
        setShowAdd(false);
      };

      const openEdit = (card)=>{
        setEditCard(card);
        setForm({ sender:card.sender, receiver:card.receiver, date:card.date, message:card.message, imgId:card.imgId });
        setShowEdit(true);
      };
      const handleEditSave = ()=>{
        setCards(cards.map(c=>c.id===editCard.id? {...c, ...form} : c));
        setStats({...stats, edit: stats.edit+1});
        setShowEdit(false);
      };

      const openDelete = (card)=>{
        setDelCard(card);
        setShowDelete(true);
      };
      const handleDeleteConfirm = ()=>{
        setCards(cards.filter(c=>c.id!==delCard.id));
        setStats({...stats, del: stats.del+1});
        setShowDelete(false);
      };

      const renderSidebar = ()=>(
        <div className="bg-white p-4 space-y-4">
          <div className="text-blue-500 font-semibold"><i className="fas fa-lock mr-2"></i>全部明信片<div className="text-xs text-gray-500 mt-1">提示：点击查看所有明信片</div></div>
          <div className="text-orange-500 font-semibold"><i className="fas fa-heart mr-2"></i>我的收藏<div className="text-xs text-gray-500 mt-1">收藏你喜欢的明信片哦！</div></div>
          <div className="text-red-500 font-semibold"><i className="fas fa-fire mr-2"></i>热门分享<div className="text-xs text-gray-500 mt-1">看看大家都在分享什么</div></div>
          <div className="text-purple-500 font-semibold"><i className="fas fa-palette mr-2"></i>特色模板<div className="text-xs text-gray-500 mt-1">使用精美模板快速创建</div></div>
          <div className="mt-6 p-2 bg-blue-50 text-blue-600 rounded text-sm">在这里分享你的心情，每一张都是回忆纪念</div>
        </div>
      );

      const renderStats = ()=>(
        <div className="p-4 bg-white space-y-4">
          <div className="text-gray-600 font-semibold">数据统计</div>
          <div className="flex items-center"><div className="text-xl font-bold mr-2">{stats.share}</div><div>分享总数</div></div>
          <div className="flex space-x-4">
            <div className="text-gray-500 text-sm">编辑次数<span className="ml-1 text-blue-500">{stats.edit}</span></div>
            <div className="text-gray-500 text-sm">删除次数<span className="ml-1 text-red-500">{stats.del}</span></div>
            <div className="ml-auto text-gray-500 cursor-pointer"><i className="fas fa-sync-alt"></i> 刷新</div>
          </div>
          <div>
            <div className="text-gray-500 text-sm mb-2">本月明信片分享走势</div>
            <div className="flex items-end h-24 space-x-1">
              {[30,50,60,65,70,80,75,85,90,80,95,100].map((h,i)=>(
                <div key={i} className="bg-blue-300" style={{width:'6%',height:`${h}%`}}></div>
              ))}
            </div>
            <div className="text-xs text-gray-400 italic mt-2">*每一张明信片都承载着一份珍贵的回忆与情感*</div>
          </div>
        </div>
      );

      const renderMain = ()=>{
        if(tab==='展示区') {
          return (
            <div className="p-4">
              <div className="flex justify-between items-center mb-4">
                <div className="text-lg font-bold">我的明信片集</div>
                <button onClick={openAdd} className="bg-yellow-500 text-white px-4 py-2 rounded flex items-center"><i className="fas fa-plus mr-2"></i>添加新明信片</button>
              </div>
              <div className="grid grid-cols-3 gap-4">
                {cards.map(card=>(
                  <div key={card.id} className="bg-white p-4 rounded shadow relative">
                    <div className="absolute top-2 right-2 text-gray-400 cursor-pointer" onClick={()=>openEdit(card)}><i className="fas fa-pencil-alt"></i></div>
                    <div className="text-sm text-blue-600"><i className="fas fa-paper-plane mr-1"></i>{card.sender}→{card.receiver}</div>
                    <div className="text-xs text-gray-500 mb-2">{card.date}</div>
                    <div className="text-gray-700 mb-2">{card.message}</div>
                    <img src={"https://picsum.photos/id/"+card.imgId+"/200/120"} alt="" className="rounded mb-2"/>
                    <div className="absolute bottom-2 right-2 text-gray-400 cursor-pointer" onClick={()=>openDelete(card)}><i className="fas fa-trash-alt"></i></div>
                  </div>
                ))}
              </div>
            </div>
          );
        } else if(tab==='编辑区'){
          return (
            <div className="p-4">
              <div className="text-lg font-bold mb-2">编辑我的明信片</div>
              <div className="bg-yellow-100 p-3 rounded mb-4 flex items-center"><i className="fas fa-lightbulb text-yellow-500 mr-2"></i><span className="text-sm">小贴士：双击文字可直接修改，按 Esc 取消编辑</span></div>
              <div className="flex justify-between mb-2">
                <div className="space-x-2">
                  <button className="bg-blue-500 text-white px-3 py-1 rounded"><i className="fas fa-plus mr-1"></i>新建模板</button>
                  <button className="bg-yellow-500 text-white px-3 py-1 rounded"><i className="fas fa-file-export mr-1"></i>导入/导出</button>
                </div>
                <button className="bg-red-200 text-gray-500 px-3 py-1 rounded" disabled>批量删除</button>
              </div>
              <div className="bg-white rounded shadow">
                {cards.map(card=>(
                  <div key={card.id} className="flex items-start border-b last:border-b-0 p-3">
                    <input type="checkbox" className="mr-3 mt-1"/>
                    <div className="flex-grow">
                      <div className="font-medium">{card.sender} 致 {card.receiver} ({card.date})</div>
                      <div className="text-gray-600">{card.message}</div>
                    </div>
                    <div className="space-x-2 text-gray-400">
                      <i className="fas fa-pencil-alt cursor-pointer" onClick={()=>openEdit(card)}></i>
                      <i className="fas fa-trash-alt cursor-pointer" onClick={()=>openDelete(card)}></i>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          );
        } else if(tab==='帮助说明'){
          return (
            <div className="p-4 space-y-6">
              <div className="text-lg font-bold text-center">使用指南</div>
              <div className="bg-yellow-50 p-4 rounded flex">
                <div className="w-2/3">
                  <div className="flex items-center mb-2"><i className="fas fa-plus-circle text-blue-500 mr-2"></i><span className="font-medium">如何添加明信片</span></div>
                  <ol className="list-decimal list-inside text-gray-700 space-y-1">
                    <li>在展示区页面点击右上角的“添加新明信片”按钮</li>
                    <li>在弹出的表单中填写发送者、接收者、日期和消息内容</li>
                    <li>选择一张邮票图片（或使用默认图片）</li>
                    <li>点击“保存”按钮完成添加</li>
                  </ol>
                </div>
                <img src="https://picsum.photos/id/200/140/100" className="w-1/3 rounded" alt=""/>
              </div>
              <div className="bg-yellow-50 p-4 rounded flex">
                <div className="w-2/3">
                  <div className="flex items-center mb-2"><i className="fas fa-edit text-blue-500 mr-2"></i><span className="font-medium">如何编辑/删除明信片</span></div>
                  <div className="text-gray-700 space-y-1">
                    <div className="font-medium">编辑明信片：</div>
                    <ol className="list-decimal list-inside space-y-1">
                      <li>在展示区找到要编辑的明信片</li>
                      <li>点击明信片右上角的“编辑”图标</li>
                      <li>在弹出的表单中修改内容</li>
                      <li>点击“保存”按钮完成编辑</li>
                    </ol>
                    <div className="font-medium mt-2">删除明信片：</div>
                    <ol className="list-decimal list-inside space-y-1">
                      <li>在展示区找到要删除的明信片</li>
                      <li>点击明信片右下角的“删除”图标</li>
                      <li>在确认对话框中点击“确认删除”</li>
                    </ol>
                  </div>
                </div>
                <img src="https://picsum.photos/id/201/140/100" className="w-1/3 rounded" alt=""/>
              </div>
              <div className="bg-yellow-50 p-4 rounded flex">
                <div className="w-2/3">
                  <div className="flex items-center mb-2"><i className="fas fa-file-import text-blue-500 mr-2"></i><span className="font-medium">导入导出功能示例</span></div>
                  <ol className="list-decimal list-inside text-gray-700 space-y-1">
                    <li>进入编辑区页面</li>
                    <li>点击顶部的“导入/导出”按钮</li>
                    <li>选择“导出为JSON”可将当前明信片集保存为文件</li>
                    <li>选择“从JSON导入”可从文件中导入明信片集</li>
                  </ol>
                </div>
                <img src="https://picsum.photos/id/202/140/100" className="w-1/3 rounded" alt=""/>
              </div>
            </div>
          );
        }
      };

      return (
        <div className="flex flex-col h-full">
          <header className="bg-white p-4 shadow-sm flex justify-center">
            <div className="text-2xl font-bold text-yellow-600">明信片分享</div>
          </header>
          <div className="flex flex-grow">
            <aside className="w-60 border-r">{renderSidebar()}</aside>
            <main className="flex-grow overflow-auto">
              <div className="bg-white flex border-b">
                {['展示区','编辑区','帮助说明'].map(name=>(
                  <div key={name}
                    className={"px-6 py-3 cursor-pointer "+(tab===name?'border-b-2 border-yellow-400 text-yellow-600':'text-gray-600')}
                    onClick={()=>setTab(name)}>
                    {name}
                  </div>
                ))}
              </div>
              {renderMain()}
            </main>
            <aside className="w-72 border-l">{renderStats()}</aside>
          </div>
          <footer className="bg-white p-4 flex justify-between items-center text-sm text-gray-500">
            <div className="space-x-4"><a href="#">常见问题</a><a href="#">联系我们</a><a href="#">隐私政策</a></div>
            <div className="italic">Tip: 保持心情美好，每一张明信片都是温暖传递~</div>
            <div>© 2024 明信片分享 版权所有</div>
          </footer>

          {/* 添加明信片 Modal */}
          {showAdd && (
            <div className="modal-bg fixed inset-0 flex items-center justify-center">
              <div className="bg-white w-1/3 p-6 rounded shadow-lg space-y-4">
                <div className="text-lg font-bold">添加新明信片</div>
                <div className="space-y-2">
                  <input type="text" placeholder="请输入发送者姓名" value={form.sender} onChange={e=>setForm({...form,sender:e.target.value})}
                    className="w-full border px-3 py-2 rounded" />
                  <input type="text" placeholder="请输入接收者姓名" value={form.receiver} onChange={e=>setForm({...form,receiver:e.target.value})}
                    className="w-full border px-3 py-2 rounded" />
                  <input type="date" value={form.date} onChange={e=>setForm({...form,date:e.target.value})}
                    className="w-full border px-3 py-2 rounded" />
                  <textarea placeholder="写下你想说的话..." value={form.message} onChange={e=>setForm({...form,message:e.target.value})}
                    className="w-full border px-3 py-2 rounded h-24"></textarea>
                </div>
                <div>
                  <div className="text-sm mb-2">选择邮票：</div>
                  <div className="flex space-x-2">
                    {imageOptions.map(id=>(
                      <img key={id}
                        src={"https://picsum.photos/id/"+id+"/80/50"}
                        className={"cursor-pointer rounded "+(form.imgId===id?'ring ring-yellow-400':'ring ring-transparent')}
                        onClick={()=>setForm({...form,imgId:id})}
                        alt="" />
                    ))}
                  </div>
                </div>
                <div className="flex justify-end space-x-2">
                  <button onClick={handleAddSave} className="bg-yellow-500 text-white px-4 py-2 rounded flex items-center"><i className="fas fa-check mr-1"></i>保存</button>
                  <button onClick={()=>setShowAdd(false)} className="bg-gray-300 text-gray-700 px-4 py-2 rounded">取消</button>
                </div>
              </div>
            </div>
          )}
          {/* 编辑明信片 Modal */}
          {showEdit && (
            <div className="modal-bg fixed inset-0 flex items-center justify-center">
              <div className="bg-white w-1/3 p-6 rounded shadow-lg space-y-4">
                <div className="text-lg font-bold">编辑明信片</div>
                <div className="space-y-2">
                  <input type="text" value={form.sender} onChange={e=>setForm({...form,sender:e.target.value})}
                    className="w-full border px-3 py-2 rounded" />
                  <input type="text" value={form.receiver} onChange={e=>setForm({...form,receiver:e.target.value})}
                    className="w-full border px-3 py-2 rounded" />
                  <input type="date" value={form.date} onChange={e=>setForm({...form,date:e.target.value})}
                    className="w-full border px-3 py-2 rounded" />
                  <textarea value={form.message} onChange={e=>setForm({...form,message:e.target.value})}
                    className="w-full border px-3 py-2 rounded h-24"></textarea>
                </div>
                <div>
                  <div className="text-sm mb-2">选择邮票：</div>
                  <div className="flex space-x-2">
                    {imageOptions.map(id=>(
                      <img key={id}
                        src={"https://picsum.photos/id/"+id+"/80/50"}
                        className={"cursor-pointer rounded "+(form.imgId===id?'ring ring-yellow-400':'ring ring-transparent')}
                        onClick={()=>setForm({...form,imgId:id})}
                        alt="" />
                    ))}
                  </div>
                </div>
                <div className="flex justify-end space-x-2">
                  <button onClick={handleEditSave} className="bg-yellow-500 text-white px-4 py-2 rounded flex items-center"><i className="fas fa-check mr-1"></i>保存</button>
                  <button onClick={()=>setShowEdit(false)} className="bg-gray-300 text-gray-700 px-4 py-2 rounded">取消</button>
                </div>
              </div>
            </div>
          )}
          {/* 删除确认 Modal */}
          {showDelete && (
            <div className="modal-bg fixed inset-0 flex items-center justify-center">
              <div className="bg-white w-1/3 p-6 rounded shadow-lg space-y-4">
                <div className="flex items-center space-x-2">
                  <i className="fas fa-exclamation-circle text-red-500 text-2xl"></i>
                  <div className="text-lg font-bold">您确定要删除这张明信片吗?</div>
                </div>
                <div className="text-gray-600">此操作无法撤销，删除后将无法恢复该明信片。</div>
                <div className="flex justify-end space-x-2">
                  <button onClick={handleDeleteConfirm} className="bg-red-500 text-white px-4 py-2 rounded">确认删除</button>
                  <button onClick={()=>setShowDelete(false)} className="bg-gray-300 text-gray-700 px-4 py-2 rounded">取消</button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
  </script>
</body>
</html>